

# test definitions for  ./mapping/config_test.go
# t0 .. t9 tables   - the name is important!  
# 
# Advanced filtering syntax:
#
#   exclude_tags
#   - [ key, val]                                  // AND key != val
#   - [ key, __nil__]                              // AND key IS NOT NULL
#   - [ key, __any__]                              // AND key IS NULL
#   - [ key, val1,val2]                            // AND key not in ( val1,val2 )                          // check: __nil__,__any__  not allowed
#   - [ key, val1,val2,val3, ... valn]             // AND key not in ( val1,val2,val3, ... valn)            // check: __nil__,__any__  not allowed
#   exclude_negated_tags
#   - [ key, val]                                  // AND key = val
#   - [ key, __nil__]                              // AND key IS NULL
#   - [ key, __any__]                              // AND key IS NOT NULL
#   - [ key, val1,val2]                            // AND key in ( val1, val2 )                              // check: __nil__,__any__  not allowed
#   - [ key, val1,val2,val3, ... valn]             // AND key in ( val1,val2,val3, ... valn)                 // check: __nil__,__any__  not allowed
#   exclude_regexp_tags:
#   - [ key, regexpr]                              // AND NOT ( regexpr.MatchString ( key.value) == true )       // see https://golang.org/pkg/regexp/
#   exclude_negated_regexp_tags:
#   - [ key, regexpr]                              // AND ( regexpr.MatchString ( key.value) == true )   // see https://golang.org/pkg/regexp/
#
# Internal processing order:  exclude_tags ->  exclude_negated_tags -> exclude_regexp_tags -> exclude_negated_regexp_tags
#
# if you want test Regexp -> https://regex-golang.appspot.com/assets/html/index.html
#
# -------------------------------------------------------------------------------------------------------------------------------------------------
#

tables:

# EXPECTED:
# ----------------------------------------------
#  where
#       (   admin_level=2 
#        OR admin_level=4) 
#  AND  boundary IN ( administrative,maritime) 
  t0:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_negated_tags:                  
      - ["boundary", "administrative","maritime"]                            
    mapping:
      admin_level:
      - '2'
      - '4'
    type: linestring


# EXPECTED:
# ----------------------------------------------
# where (
#             (boundary is not null)  
#         OR  (admin_level is not null )
#       )
# AND  admin_level IN (2,4) 
  t1:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_negated_tags:
      - ["admin_level", "2","4"]                            
    mapping:
      boundary:
      - administrative
      - maritime
    type: linestring


# EXPECTED:
# ----------------------------------------------
# where (
#             (boundary is not null)  
#         OR  (admin_level is not null )
#       )
# AND  admin_level IN (2,4) 
# AND  boundary    IN (administrative,maritime)  
#
# -------------------------------------------------------
# !Note can be eliminated
#       exclude_negated_tags:   ["admin_level", "5","6","7","8"]            -->    AND  admin_level     IN (5,6,7,8)
#       exclude_tags:           ["admin_level", "5","6","7","8"]            -->    AND  admin_level NOT IN (5,6,7,8)
#

  t2:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_negated_tags:
      - ["admin_level", "2","4","5","6","7","8"] 
      - ["boundary", "administrative","maritime"]
      exclude_tags:
      - ["admin_level", "5","6","7","8"]                                         
    mapping:
      boundary:
      - __any__
      admin_level:
      - __any__
    type: linestring


# EXPECTED:
# ----------------------------------------------
# where (
#             (boundary    IS NOT NULL )  
#         OR  (admin_level IS NOT NULL )
#       )
# AND admin_level IN (2,4)  
# AND admin_level NOT NULL  
# AND boundary    IN (administrative,maritime)
# AND boundary    NOT NULL
  t3:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_negated_tags:
      - ["admin_level", "2","4"]
      - ["admin_level", "__any__"]        
      - ["boundary", "administrative","maritime"]
      - ["boundary", "__any__"]                                          
    mapping:
      boundary:
      - __any__
      admin_level:
      - __any__
    type: linestring



# EXPECTED:
# ----------------------------------------------
# where (
#             (boundary    IS NOT NULL )  
#         OR  (admin_level IS NOT NULL )
#       )
# AND admin_level != 'X'  
# AND admin_level != 'Y'  
# AND admin_level != '0'  
# AND admin_level != '1'  
# AND admin_level != '3'  
# AND admin_level != '5'  
# AND admin_level != '6'  
# AND admin_level != '7' 
# AND admin_level != '8'  
# AND admin_level NOT NULL
  t4:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_tags:
      - ["admin_level", "X"] 
      - ["admin_level", "Y"] 
      - ["admin_level", "0"]  
      - ["admin_level", "1"] 
      - ["admin_level", "3"] 
      - ["admin_level", "5"]
      - ["admin_level", "6"] 
      - ["admin_level", "7"] 
      - ["admin_level", "8"]                            
      - ["admin_level", "__nil__"]                             
    mapping:
      boundary:
      - administrative
      - maritime
    type: linestring    






# EXPECTED:
# ----------------------------------------------
# where (
#             (boundary    IS NOT NULL )  
#         OR  (admin_level IS NOT NULL )
#       )
# AND admin_level != 'X'  
# AND admin_level != 'Y'  
# AND admin_level != '0'  
# AND admin_level != '1'  
# AND admin_level != '3'  
# AND admin_level != '5'  
# AND admin_level != '6'  
# AND admin_level != '7' 
# AND admin_level != '8'  
# AND admin_level NOT NULL
# AND boundary NOT NULL
# AND boundary != 'political'  
# AND boundary != 'census'  
# AND boundary != 'cadastral'  
# AND boundary != 'national_park'  
  t5:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_tags:
      - ["admin_level", "X"] 
      - ["admin_level", "Y"] 
      - ["admin_level", "0"]  
      - ["admin_level", "1"] 
      - ["admin_level", "3"] 
      - ["admin_level", "5"]
      - ["admin_level", "6"] 
      - ["admin_level", "7"] 
      - ["admin_level", "8"]                            
      - ["admin_level", "__nil__"] 
      - ["boundary", "__nil__"] 
      - ["boundary", "political"]
      - ["boundary", "census"]  
      - ["boundary", "cadastral"]  
      - ["boundary", "national_park"]                                                      
    mapping:
      boundary:
      - __any__
      admin_level:
      - __any__
    type: linestring    
  




# EXPECTED:
# ----------------------------------------------
# Where 
# (      boundary=administrative 
#     OR boundary=maritime
# )  
# AND name IS NOT NULL 
  t6:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_tags:                       
      - ["name", "__nil__"]                             
    mapping:
      boundary:
      - administrative
      - maritime
    type: linestring 
      
  
  
# EXPECTED -  
# ----------------------------------------------
# Where 
# (      boundary=administrative 
#     OR boundary=maritime
# )  
# AND name IS NOT NULL
# AND name.value  IS regexpMatchString('^[a-zA-Z]*$' )   
#
#
  t7:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_tags:                       
      - ["name", "__nil__"]
      exclude_negated_regexp_tags:                       
      - ["name", '^[a-zA-Z]*$']                                      
    mapping:
      boundary:
      - administrative
      - maritime
    type: linestring 
      

# EXPECTED:
# ----------------------------------------------
# Where 
# (      boundary=administrative
#     OR boundary=maritime 
# )  
# AND admin_level.value  IS NOT regexpMatchString('^[0-9]+$' )   
#
# see: https://regex-golang.appspot.com/assets/html/index.html
#
# Note: be careful because yaml interprets escape sequences inside double quoted strings!
#       so use  single quoted string !

  t8:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_regexp_tags:                       
      - ["admin_level", '^[0-9]+$']                             
    mapping:
      boundary:
      - administrative
      - maritime      
    type: linestring 
      
  

# EXPECTED:
# ----------------------------------------------
# Where 
# (      boundary is NOT NULL 
# )  
# AND boundary.value  IS regexpMatchString( '^[a-z_]+$' )    //   only   [a-z_] is a valid osm values for boundary  ... 
#
# see: https://regex-golang.appspot.com/assets/html/index.html
#
# Note: be careful because yaml interprets escape sequences inside double quoted strings!
#       so use  single quoted string !
 
  t9:
    fields:
    - name: id
      type: id
    - key: admin_level
      name: admin_level
      type: integer
    filters:
      exclude_negated_regexp_tags:                       
      - ["boundary", '^[a-z_]+$']                             
    mapping:
      boundary:
      - __any__    
    type: linestring 
  
